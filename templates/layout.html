{% macro nav_item(path, text) %}
  <a href="{{ path }}" {% if request.path == path %}class="active"{% endif %}>{{ text }}</a>
{% endmacro %}


<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="static/styles.css" media="screen" />
    <title>Mini and BMW website</title>
  </head>

  <body>
    <!-- This is the navbar at the top of the website -->
    <div class="topnav">
      {{ nav_item('/home', 'Home Page') }}
      {{ nav_item('/mini', 'Minis Page') }}
      {{ nav_item('/bmw', 'BMW Page') }}
      {{ nav_item('/feedback', 'Feedback') }}
      <!-- <a class="active" href="/home">Home Page</a> -->
      <!-- <a href="/mini">Minis Page</a> -->
      <!-- <a href="/bmw">BMW Page</a> -->
      <!-- <a href="/feedback">Feedback</a> -->
    </div>

    <button class="btn-toggle">Toggle Dark-Mode</button>

    <div class="rest">
      {% block main %} {% endblock main %}
    </div>

    {% block script %}
    <script>
      // media query
      const colorThemeMatch = window.matchMedia("(prefers-color-scheme: dark)");

      function updateColorScheme() {
        // if the user has set a theme dont use perfered
        if (localStorage.getItem("dark-theme") !== null) return;
        // set approprate theme
        if (colorThemeMatch.matches) {
          document.body.classList.add("dark-theme");
        }
      }

      updateColorScheme(); // update the scheme checking user theme

      colorThemeMatch.addListener(updateColorScheme); // listen for a user theme changex

      if (JSON.parse(localStorage.getItem("dark-theme"))) {
        document.body.classList.add("dark-theme");
      }

      document.querySelector(".btn-toggle").addEventListener("click", () => {
        document.body.classList.toggle("dark-theme");
        localStorage.setItem(
          "dark-theme",
          document.body.classList.contains("dark-theme")
        );
      });
    </script>

    
    {% endblock script %}
  </body>
</html>
